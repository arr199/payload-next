"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _qs = /*#__PURE__*/ _interop_require_default(require("qs"));
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _reacti18next = require("react-i18next");
const _validations = require("../../../../../fields/validations");
const _wordBoundariesRegex = /*#__PURE__*/ _interop_require_default(require("../../../../../utilities/wordBoundariesRegex"));
const _useDebouncedCallback = require("../../../../hooks/useDebouncedCallback");
const _ReactSelect = /*#__PURE__*/ _interop_require_default(require("../../../elements/ReactSelect"));
const _Auth = require("../../../utilities/Auth");
const _Config = require("../../../utilities/Config");
const _GetFilterOptions = require("../../../utilities/GetFilterOptions");
const _Locale = require("../../../utilities/Locale");
const _Error = /*#__PURE__*/ _interop_require_default(require("../../Error"));
const _FieldDescription = /*#__PURE__*/ _interop_require_default(require("../../FieldDescription"));
const _context = require("../../Form/context");
const _Label = /*#__PURE__*/ _interop_require_default(require("../../Label"));
const _useField = /*#__PURE__*/ _interop_require_default(require("../../useField"));
const _withCondition = /*#__PURE__*/ _interop_require_default(require("../../withCondition"));
const _shared = require("../shared");
const _AddNew = require("./AddNew");
const _createRelationMap = require("./createRelationMap");
const _findOptionsByValue = require("./findOptionsByValue");
require("./index.scss");
const _optionsReducer = /*#__PURE__*/ _interop_require_default(require("./optionsReducer"));
const _MultiValueLabel = require("./select-components/MultiValueLabel");
const _SingleValue = require("./select-components/SingleValue");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {};
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const maxResultsPerRequest = 10;
const baseClass = 'relationship';
const Relationship = (props)=>{
    const { name, admin: { allowCreate = true, className, components: { Error, Label } = {}, condition, description, isSortable = true, readOnly, sortOptions, style, width } = {}, filterOptions, hasMany, label, path, relationTo, required, validate = _validations.relationship } = props;
    const ErrorComp = Error || _Error.default;
    const LabelComp = Label || _Label.default;
    const config = (0, _Config.useConfig)();
    const { collections, routes: { api }, serverURL } = config;
    const { i18n, t } = (0, _reacti18next.useTranslation)('fields');
    const { permissions } = (0, _Auth.useAuth)();
    const { code: locale } = (0, _Locale.useLocale)();
    const formProcessing = (0, _context.useFormProcessing)();
    const hasMultipleRelations = Array.isArray(relationTo);
    const [options, dispatchOptions] = (0, _react.useReducer)(_optionsReducer.default, []);
    const [lastFullyLoadedRelation, setLastFullyLoadedRelation] = (0, _react.useState)(-1);
    const [lastLoadedPage, setLastLoadedPage] = (0, _react.useState)({});
    const [errorLoading, setErrorLoading] = (0, _react.useState)('');
    const [filterOptionsResult, setFilterOptionsResult] = (0, _react.useState)();
    const [search, setSearch] = (0, _react.useState)('');
    const [isLoading, setIsLoading] = (0, _react.useState)(false);
    const [hasLoadedFirstPage, setHasLoadedFirstPage] = (0, _react.useState)(false);
    const [enableWordBoundarySearch, setEnableWordBoundarySearch] = (0, _react.useState)(false);
    const firstRun = (0, _react.useRef)(true);
    const pathOrName = path || name;
    const memoizedValidate = (0, _react.useCallback)((value, validationOptions)=>{
        return validate(value, {
            ...validationOptions,
            required
        });
    }, [
        validate,
        required
    ]);
    const { errorMessage, initialValue, setValue, showError, value } = (0, _useField.default)({
        condition,
        path: pathOrName,
        validate: memoizedValidate
    });
    const [drawerIsOpen, setDrawerIsOpen] = (0, _react.useState)(false);
    const getResults = (0, _react.useCallback)(async ({ lastFullyLoadedRelation: lastFullyLoadedRelationArg, onSuccess, search: searchArg, sort, value: valueArg })=>{
        if (!permissions) {
            return;
        }
        const lastFullyLoadedRelationToUse = typeof lastFullyLoadedRelationArg !== 'undefined' ? lastFullyLoadedRelationArg : -1;
        const relations = Array.isArray(relationTo) ? relationTo : [
            relationTo
        ];
        const relationsToFetch = lastFullyLoadedRelationToUse === -1 ? relations : relations.slice(lastFullyLoadedRelationToUse + 1);
        let resultsFetched = 0;
        const relationMap = (0, _createRelationMap.createRelationMap)({
            hasMany,
            relationTo,
            value: valueArg
        });
        if (!errorLoading) {
            relationsToFetch.reduce(async (priorRelation, relation)=>{
                const relationFilterOption = filterOptionsResult?.[relation];
                let lastLoadedPageToUse;
                if (search !== searchArg) {
                    lastLoadedPageToUse = 1;
                } else {
                    lastLoadedPageToUse = lastLoadedPage[relation] + 1;
                }
                await priorRelation;
                if (relationFilterOption === false) {
                    setLastFullyLoadedRelation(relations.indexOf(relation));
                    return Promise.resolve();
                }
                if (resultsFetched < 10) {
                    const collection = collections.find((coll)=>coll.slug === relation);
                    let fieldToSearch = collection?.defaultSort || collection?.admin?.useAsTitle || 'id';
                    if (!searchArg) {
                        if (typeof sortOptions === 'string') {
                            fieldToSearch = sortOptions;
                        } else if (sortOptions?.[relation]) {
                            fieldToSearch = sortOptions[relation];
                        }
                    }
                    const query = {
                        depth: 0,
                        limit: maxResultsPerRequest,
                        locale,
                        page: lastLoadedPageToUse,
                        sort: fieldToSearch,
                        where: {
                            and: [
                                {
                                    id: {
                                        not_in: relationMap[relation]
                                    }
                                }
                            ]
                        }
                    };
                    if (searchArg) {
                        query.where.and.push({
                            [fieldToSearch]: {
                                like: searchArg
                            }
                        });
                    }
                    if (relationFilterOption && typeof relationFilterOption !== 'boolean') {
                        query.where.and.push(relationFilterOption);
                    }
                    const response = await fetch(`${serverURL}${api}/${relation}?${_qs.default.stringify(query)}`, {
                        credentials: 'include',
                        headers: {
                            'Accept-Language': i18n.language
                        }
                    });
                    if (response.ok) {
                        const data = await response.json();
                        setLastLoadedPage((prevState)=>{
                            return {
                                ...prevState,
                                [relation]: lastLoadedPageToUse
                            };
                        });
                        if (!data.nextPage) {
                            setLastFullyLoadedRelation(relations.indexOf(relation));
                        }
                        if (data.docs.length > 0) {
                            resultsFetched += data.docs.length;
                            dispatchOptions({
                                collection,
                                config,
                                docs: data.docs,
                                i18n,
                                sort,
                                type: 'ADD'
                            });
                        }
                    } else if (response.status === 403) {
                        setLastFullyLoadedRelation(relations.indexOf(relation));
                        dispatchOptions({
                            collection,
                            config,
                            docs: [],
                            i18n,
                            ids: relationMap[relation],
                            sort,
                            type: 'ADD'
                        });
                    } else {
                        setErrorLoading(t('error:unspecific'));
                    }
                }
            }, Promise.resolve());
            if (typeof onSuccess === 'function') onSuccess();
        }
    }, [
        permissions,
        relationTo,
        hasMany,
        errorLoading,
        search,
        lastLoadedPage,
        collections,
        locale,
        filterOptionsResult,
        serverURL,
        sortOptions,
        api,
        i18n,
        config,
        t
    ]);
    const updateSearch = (0, _useDebouncedCallback.useDebouncedCallback)((searchArg, valueArg)=>{
        getResults({
            search: searchArg,
            sort: true,
            value: valueArg
        });
        setSearch(searchArg);
    }, 300);
    const handleInputChange = (0, _react.useCallback)((searchArg, valueArg)=>{
        if (search !== searchArg) {
            setLastLoadedPage({});
            updateSearch(searchArg, valueArg, searchArg !== '');
        }
    }, [
        search,
        updateSearch
    ]);
    // ///////////////////////////////////
    // Ensure we have an option for each value
    // ///////////////////////////////////
    (0, _react.useEffect)(()=>{
        const relationMap = (0, _createRelationMap.createRelationMap)({
            hasMany,
            relationTo,
            value
        });
        Object.entries(relationMap).reduce(async (priorRelation, [relation, ids])=>{
            await priorRelation;
            const idsToLoad = ids.filter((id)=>{
                return !options.find((optionGroup)=>optionGroup?.options?.find((option)=>option.value === id && option.relationTo === relation));
            });
            if (idsToLoad.length > 0) {
                const query = {
                    depth: 0,
                    limit: idsToLoad.length,
                    locale,
                    where: {
                        id: {
                            in: idsToLoad
                        }
                    }
                };
                if (!errorLoading) {
                    const response = await fetch(`${serverURL}${api}/${relation}?${_qs.default.stringify(query)}`, {
                        credentials: 'include',
                        headers: {
                            'Accept-Language': i18n.language
                        }
                    });
                    const collection = collections.find((coll)=>coll.slug === relation);
                    let docs = [];
                    if (response.ok) {
                        const data = await response.json();
                        docs = data.docs;
                    }
                    dispatchOptions({
                        collection,
                        config,
                        docs,
                        i18n,
                        ids: idsToLoad,
                        sort: true,
                        type: 'ADD'
                    });
                }
            }
        }, Promise.resolve());
    }, [
        options,
        value,
        hasMany,
        errorLoading,
        collections,
        hasMultipleRelations,
        serverURL,
        api,
        i18n,
        relationTo,
        locale,
        config
    ]);
    // Determine if we should switch to word boundary search
    (0, _react.useEffect)(()=>{
        const relations = Array.isArray(relationTo) ? relationTo : [
            relationTo
        ];
        const isIdOnly = relations.reduce((idOnly, relation)=>{
            const collection = collections.find((coll)=>coll.slug === relation);
            const fieldToSearch = collection?.admin?.useAsTitle || 'id';
            return fieldToSearch === 'id' && idOnly;
        }, true);
        setEnableWordBoundarySearch(!isIdOnly);
    }, [
        relationTo,
        collections
    ]);
    // When (`relationTo` || `filterOptionsResult` || `locale`) changes, reset component
    // Note - effect should not run on first run
    (0, _react.useEffect)(()=>{
        if (firstRun.current) {
            firstRun.current = false;
            return;
        }
        dispatchOptions({
            type: 'CLEAR'
        });
        setLastFullyLoadedRelation(-1);
        setLastLoadedPage({});
        setHasLoadedFirstPage(false);
    }, [
        relationTo,
        filterOptionsResult,
        locale
    ]);
    const onSave = (0, _react.useCallback)((args)=>{
        dispatchOptions({
            collection: args.collectionConfig,
            config,
            doc: args.doc,
            i18n,
            type: 'UPDATE'
        });
    }, [
        i18n,
        config
    ]);
    const filterOption = (0, _react.useCallback)((item, searchFilter)=>{
        if (!searchFilter) {
            return true;
        }
        const r = (0, _wordBoundariesRegex.default)(searchFilter || '');
        // breaking the labels to search into smaller parts increases performance
        const breakApartThreshold = 250;
        let string = item.label;
        // strings less than breakApartThreshold length won't be chunked
        while(string.length > breakApartThreshold){
            // slicing by the next space after the length of the search input prevents slicing the string up by partial words
            const indexOfSpace = string.indexOf(' ', searchFilter.length);
            if (r.test(string.slice(0, indexOfSpace === -1 ? searchFilter.length : indexOfSpace + 1))) {
                return true;
            }
            string = string.slice(indexOfSpace === -1 ? searchFilter.length : indexOfSpace + 1);
        }
        return r.test(string.slice(-breakApartThreshold));
    }, []);
    const valueToRender = (0, _findOptionsByValue.findOptionsByValue)({
        options,
        value
    });
    if (!Array.isArray(valueToRender) && valueToRender?.value === 'null') valueToRender.value = null;
    return /*#__PURE__*/ _react.default.createElement("div", {
        className: [
            _shared.fieldBaseClass,
            baseClass,
            className,
            showError && 'error',
            errorLoading && 'error-loading',
            readOnly && `${baseClass}--read-only`
        ].filter(Boolean).join(' '),
        id: `field-${pathOrName.replace(/\./g, '__')}`,
        style: {
            ...style,
            width
        }
    }, /*#__PURE__*/ _react.default.createElement(ErrorComp, {
        message: errorMessage,
        showError: showError
    }), /*#__PURE__*/ _react.default.createElement(LabelComp, {
        htmlFor: pathOrName,
        label: label,
        required: required
    }), /*#__PURE__*/ _react.default.createElement(_GetFilterOptions.GetFilterOptions, {
        filterOptions,
        filterOptionsResult,
        path: pathOrName,
        relationTo,
        setFilterOptionsResult
    }), !errorLoading && /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__wrap`
    }, /*#__PURE__*/ _react.default.createElement(_ReactSelect.default, {
        backspaceRemovesValue: !drawerIsOpen,
        components: {
            MultiValueLabel: _MultiValueLabel.MultiValueLabel,
            SingleValue: _SingleValue.SingleValue
        },
        customProps: {
            disableKeyDown: drawerIsOpen,
            disableMouseDown: drawerIsOpen,
            onSave,
            setDrawerIsOpen
        },
        disabled: readOnly || formProcessing,
        filterOption: enableWordBoundarySearch ? filterOption : undefined,
        isLoading: isLoading,
        isMulti: hasMany,
        isSortable: isSortable,
        onChange: !readOnly ? (selected)=>{
            if (selected === null) {
                setValue(hasMany ? [] : null);
            } else if (hasMany) {
                setValue(selected ? selected.map((option)=>{
                    if (hasMultipleRelations) {
                        return {
                            relationTo: option.relationTo,
                            value: option.value
                        };
                    }
                    return option.value;
                }) : null);
            } else if (hasMultipleRelations) {
                setValue({
                    relationTo: selected.relationTo,
                    value: selected.value
                });
            } else {
                setValue(selected.value);
            }
        } : undefined,
        onInputChange: (newSearch)=>handleInputChange(newSearch, value),
        onMenuOpen: ()=>{
            if (!hasLoadedFirstPage) {
                setIsLoading(true);
                getResults({
                    onSuccess: ()=>{
                        setHasLoadedFirstPage(true);
                        setIsLoading(false);
                    },
                    value: initialValue
                });
            }
        },
        onMenuScrollToBottom: ()=>{
            getResults({
                lastFullyLoadedRelation,
                search,
                sort: false,
                value: initialValue
            });
        },
        options: options,
        showError: showError,
        value: valueToRender ?? null
    }), !readOnly && allowCreate && /*#__PURE__*/ _react.default.createElement(_AddNew.AddNewRelation, {
        dispatchOptions,
        hasMany,
        options,
        path: pathOrName,
        relationTo,
        setValue,
        value
    })), errorLoading && /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__error-loading`
    }, errorLoading), /*#__PURE__*/ _react.default.createElement(_FieldDescription.default, {
        description: description,
        path: path,
        value: value
    }));
};
const _default = (0, _withCondition.default)(Relationship);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2Zvcm1zL2ZpZWxkLXR5cGVzL1JlbGF0aW9uc2hpcC9pbmRleC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHFzIGZyb20gJ3FzJ1xuaW1wb3J0IFJlYWN0LCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZVJlZHVjZXIsIHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHVzZVRyYW5zbGF0aW9uIH0gZnJvbSAncmVhY3QtaTE4bmV4dCdcblxuaW1wb3J0IHR5cGUgeyBQYWdpbmF0ZWREb2NzIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vZGF0YWJhc2UvdHlwZXMnXG5pbXBvcnQgdHlwZSB7IFdoZXJlIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vdHlwZXMnXG5pbXBvcnQgdHlwZSB7IERvY3VtZW50RHJhd2VyUHJvcHMgfSBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9Eb2N1bWVudERyYXdlci90eXBlcydcbmltcG9ydCB0eXBlIHsgRmlsdGVyT3B0aW9uc1Jlc3VsdCwgR2V0UmVzdWx0cywgT3B0aW9uLCBQcm9wcywgVmFsdWUgfSBmcm9tICcuL3R5cGVzJ1xuXG5pbXBvcnQgeyByZWxhdGlvbnNoaXAgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9maWVsZHMvdmFsaWRhdGlvbnMnXG5pbXBvcnQgd29yZEJvdW5kYXJpZXNSZWdleCBmcm9tICcuLi8uLi8uLi8uLi8uLi91dGlsaXRpZXMvd29yZEJvdW5kYXJpZXNSZWdleCdcbmltcG9ydCB7IHVzZURlYm91bmNlZENhbGxiYWNrIH0gZnJvbSAnLi4vLi4vLi4vLi4vaG9va3MvdXNlRGVib3VuY2VkQ2FsbGJhY2snXG5pbXBvcnQgUmVhY3RTZWxlY3QgZnJvbSAnLi4vLi4vLi4vZWxlbWVudHMvUmVhY3RTZWxlY3QnXG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0aWVzL0F1dGgnXG5pbXBvcnQgeyB1c2VDb25maWcgfSBmcm9tICcuLi8uLi8uLi91dGlsaXRpZXMvQ29uZmlnJ1xuaW1wb3J0IHsgR2V0RmlsdGVyT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdGllcy9HZXRGaWx0ZXJPcHRpb25zJ1xuaW1wb3J0IHsgdXNlTG9jYWxlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0aWVzL0xvY2FsZSdcbmltcG9ydCBEZWZhdWx0RXJyb3IgZnJvbSAnLi4vLi4vRXJyb3InXG5pbXBvcnQgRmllbGREZXNjcmlwdGlvbiBmcm9tICcuLi8uLi9GaWVsZERlc2NyaXB0aW9uJ1xuaW1wb3J0IHsgdXNlRm9ybVByb2Nlc3NpbmcgfSBmcm9tICcuLi8uLi9Gb3JtL2NvbnRleHQnXG5pbXBvcnQgRGVmYXVsdExhYmVsIGZyb20gJy4uLy4uL0xhYmVsJ1xuaW1wb3J0IHVzZUZpZWxkIGZyb20gJy4uLy4uL3VzZUZpZWxkJ1xuaW1wb3J0IHdpdGhDb25kaXRpb24gZnJvbSAnLi4vLi4vd2l0aENvbmRpdGlvbidcbmltcG9ydCB7IGZpZWxkQmFzZUNsYXNzIH0gZnJvbSAnLi4vc2hhcmVkJ1xuaW1wb3J0IHsgQWRkTmV3UmVsYXRpb24gfSBmcm9tICcuL0FkZE5ldydcbmltcG9ydCB7IGNyZWF0ZVJlbGF0aW9uTWFwIH0gZnJvbSAnLi9jcmVhdGVSZWxhdGlvbk1hcCdcbmltcG9ydCB7IGZpbmRPcHRpb25zQnlWYWx1ZSB9IGZyb20gJy4vZmluZE9wdGlvbnNCeVZhbHVlJ1xuaW1wb3J0ICcuL2luZGV4LnNjc3MnXG5pbXBvcnQgb3B0aW9uc1JlZHVjZXIgZnJvbSAnLi9vcHRpb25zUmVkdWNlcidcbmltcG9ydCB7IE11bHRpVmFsdWVMYWJlbCB9IGZyb20gJy4vc2VsZWN0LWNvbXBvbmVudHMvTXVsdGlWYWx1ZUxhYmVsJ1xuaW1wb3J0IHsgU2luZ2xlVmFsdWUgfSBmcm9tICcuL3NlbGVjdC1jb21wb25lbnRzL1NpbmdsZVZhbHVlJ1xuXG5jb25zdCBtYXhSZXN1bHRzUGVyUmVxdWVzdCA9IDEwXG5cbmNvbnN0IGJhc2VDbGFzcyA9ICdyZWxhdGlvbnNoaXAnXG5cbmNvbnN0IFJlbGF0aW9uc2hpcDogUmVhY3QuRkM8UHJvcHM+ID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0IHtcbiAgICBuYW1lLFxuICAgIGFkbWluOiB7XG4gICAgICBhbGxvd0NyZWF0ZSA9IHRydWUsXG4gICAgICBjbGFzc05hbWUsXG4gICAgICBjb21wb25lbnRzOiB7IEVycm9yLCBMYWJlbCB9ID0ge30sXG4gICAgICBjb25kaXRpb24sXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIGlzU29ydGFibGUgPSB0cnVlLFxuICAgICAgcmVhZE9ubHksXG4gICAgICBzb3J0T3B0aW9ucyxcbiAgICAgIHN0eWxlLFxuICAgICAgd2lkdGgsXG4gICAgfSA9IHt9LFxuICAgIGZpbHRlck9wdGlvbnMsXG4gICAgaGFzTWFueSxcbiAgICBsYWJlbCxcbiAgICBwYXRoLFxuICAgIHJlbGF0aW9uVG8sXG4gICAgcmVxdWlyZWQsXG4gICAgdmFsaWRhdGUgPSByZWxhdGlvbnNoaXAsXG4gIH0gPSBwcm9wc1xuXG4gIGNvbnN0IEVycm9yQ29tcCA9IEVycm9yIHx8IERlZmF1bHRFcnJvclxuICBjb25zdCBMYWJlbENvbXAgPSBMYWJlbCB8fCBEZWZhdWx0TGFiZWxcblxuICBjb25zdCBjb25maWcgPSB1c2VDb25maWcoKVxuXG4gIGNvbnN0IHtcbiAgICBjb2xsZWN0aW9ucyxcbiAgICByb3V0ZXM6IHsgYXBpIH0sXG4gICAgc2VydmVyVVJMLFxuICB9ID0gY29uZmlnXG5cbiAgY29uc3QgeyBpMThuLCB0IH0gPSB1c2VUcmFuc2xhdGlvbignZmllbGRzJylcbiAgY29uc3QgeyBwZXJtaXNzaW9ucyB9ID0gdXNlQXV0aCgpXG4gIGNvbnN0IHsgY29kZTogbG9jYWxlIH0gPSB1c2VMb2NhbGUoKVxuICBjb25zdCBmb3JtUHJvY2Vzc2luZyA9IHVzZUZvcm1Qcm9jZXNzaW5nKClcbiAgY29uc3QgaGFzTXVsdGlwbGVSZWxhdGlvbnMgPSBBcnJheS5pc0FycmF5KHJlbGF0aW9uVG8pXG4gIGNvbnN0IFtvcHRpb25zLCBkaXNwYXRjaE9wdGlvbnNdID0gdXNlUmVkdWNlcihvcHRpb25zUmVkdWNlciwgW10pXG4gIGNvbnN0IFtsYXN0RnVsbHlMb2FkZWRSZWxhdGlvbiwgc2V0TGFzdEZ1bGx5TG9hZGVkUmVsYXRpb25dID0gdXNlU3RhdGUoLTEpXG4gIGNvbnN0IFtsYXN0TG9hZGVkUGFnZSwgc2V0TGFzdExvYWRlZFBhZ2VdID0gdXNlU3RhdGU8UmVjb3JkPHN0cmluZywgbnVtYmVyPj4oe30pXG4gIGNvbnN0IFtlcnJvckxvYWRpbmcsIHNldEVycm9yTG9hZGluZ10gPSB1c2VTdGF0ZSgnJylcbiAgY29uc3QgW2ZpbHRlck9wdGlvbnNSZXN1bHQsIHNldEZpbHRlck9wdGlvbnNSZXN1bHRdID0gdXNlU3RhdGU8RmlsdGVyT3B0aW9uc1Jlc3VsdD4oKVxuICBjb25zdCBbc2VhcmNoLCBzZXRTZWFyY2hdID0gdXNlU3RhdGUoJycpXG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW2hhc0xvYWRlZEZpcnN0UGFnZSwgc2V0SGFzTG9hZGVkRmlyc3RQYWdlXSA9IHVzZVN0YXRlKGZhbHNlKVxuICBjb25zdCBbZW5hYmxlV29yZEJvdW5kYXJ5U2VhcmNoLCBzZXRFbmFibGVXb3JkQm91bmRhcnlTZWFyY2hdID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IGZpcnN0UnVuID0gdXNlUmVmKHRydWUpXG4gIGNvbnN0IHBhdGhPck5hbWUgPSBwYXRoIHx8IG5hbWVcblxuICBjb25zdCBtZW1vaXplZFZhbGlkYXRlID0gdXNlQ2FsbGJhY2soXG4gICAgKHZhbHVlLCB2YWxpZGF0aW9uT3B0aW9ucykgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlKHZhbHVlLCB7IC4uLnZhbGlkYXRpb25PcHRpb25zLCByZXF1aXJlZCB9KVxuICAgIH0sXG4gICAgW3ZhbGlkYXRlLCByZXF1aXJlZF0sXG4gIClcblxuICBjb25zdCB7IGVycm9yTWVzc2FnZSwgaW5pdGlhbFZhbHVlLCBzZXRWYWx1ZSwgc2hvd0Vycm9yLCB2YWx1ZSB9ID0gdXNlRmllbGQ8VmFsdWUgfCBWYWx1ZVtdPih7XG4gICAgY29uZGl0aW9uLFxuICAgIHBhdGg6IHBhdGhPck5hbWUsXG4gICAgdmFsaWRhdGU6IG1lbW9pemVkVmFsaWRhdGUsXG4gIH0pXG5cbiAgY29uc3QgW2RyYXdlcklzT3Blbiwgc2V0RHJhd2VySXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKVxuXG4gIGNvbnN0IGdldFJlc3VsdHM6IEdldFJlc3VsdHMgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAoe1xuICAgICAgbGFzdEZ1bGx5TG9hZGVkUmVsYXRpb246IGxhc3RGdWxseUxvYWRlZFJlbGF0aW9uQXJnLFxuICAgICAgb25TdWNjZXNzLFxuICAgICAgc2VhcmNoOiBzZWFyY2hBcmcsXG4gICAgICBzb3J0LFxuICAgICAgdmFsdWU6IHZhbHVlQXJnLFxuICAgIH0pID0+IHtcbiAgICAgIGlmICghcGVybWlzc2lvbnMpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb25zdCBsYXN0RnVsbHlMb2FkZWRSZWxhdGlvblRvVXNlID1cbiAgICAgICAgdHlwZW9mIGxhc3RGdWxseUxvYWRlZFJlbGF0aW9uQXJnICE9PSAndW5kZWZpbmVkJyA/IGxhc3RGdWxseUxvYWRlZFJlbGF0aW9uQXJnIDogLTFcblxuICAgICAgY29uc3QgcmVsYXRpb25zID0gQXJyYXkuaXNBcnJheShyZWxhdGlvblRvKSA/IHJlbGF0aW9uVG8gOiBbcmVsYXRpb25Ub11cbiAgICAgIGNvbnN0IHJlbGF0aW9uc1RvRmV0Y2ggPVxuICAgICAgICBsYXN0RnVsbHlMb2FkZWRSZWxhdGlvblRvVXNlID09PSAtMVxuICAgICAgICAgID8gcmVsYXRpb25zXG4gICAgICAgICAgOiByZWxhdGlvbnMuc2xpY2UobGFzdEZ1bGx5TG9hZGVkUmVsYXRpb25Ub1VzZSArIDEpXG5cbiAgICAgIGxldCByZXN1bHRzRmV0Y2hlZCA9IDBcbiAgICAgIGNvbnN0IHJlbGF0aW9uTWFwID0gY3JlYXRlUmVsYXRpb25NYXAoe1xuICAgICAgICBoYXNNYW55LFxuICAgICAgICByZWxhdGlvblRvLFxuICAgICAgICB2YWx1ZTogdmFsdWVBcmcsXG4gICAgICB9KVxuXG4gICAgICBpZiAoIWVycm9yTG9hZGluZykge1xuICAgICAgICByZWxhdGlvbnNUb0ZldGNoLnJlZHVjZShhc3luYyAocHJpb3JSZWxhdGlvbiwgcmVsYXRpb24pID0+IHtcbiAgICAgICAgICBjb25zdCByZWxhdGlvbkZpbHRlck9wdGlvbiA9IGZpbHRlck9wdGlvbnNSZXN1bHQ/LltyZWxhdGlvbl1cbiAgICAgICAgICBsZXQgbGFzdExvYWRlZFBhZ2VUb1VzZVxuICAgICAgICAgIGlmIChzZWFyY2ggIT09IHNlYXJjaEFyZykge1xuICAgICAgICAgICAgbGFzdExvYWRlZFBhZ2VUb1VzZSA9IDFcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGFzdExvYWRlZFBhZ2VUb1VzZSA9IGxhc3RMb2FkZWRQYWdlW3JlbGF0aW9uXSArIDFcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgcHJpb3JSZWxhdGlvblxuXG4gICAgICAgICAgaWYgKHJlbGF0aW9uRmlsdGVyT3B0aW9uID09PSBmYWxzZSkge1xuICAgICAgICAgICAgc2V0TGFzdEZ1bGx5TG9hZGVkUmVsYXRpb24ocmVsYXRpb25zLmluZGV4T2YocmVsYXRpb24pKVxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHJlc3VsdHNGZXRjaGVkIDwgMTApIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBjb2xsZWN0aW9ucy5maW5kKChjb2xsKSA9PiBjb2xsLnNsdWcgPT09IHJlbGF0aW9uKVxuICAgICAgICAgICAgbGV0IGZpZWxkVG9TZWFyY2ggPSBjb2xsZWN0aW9uPy5kZWZhdWx0U29ydCB8fCBjb2xsZWN0aW9uPy5hZG1pbj8udXNlQXNUaXRsZSB8fCAnaWQnXG4gICAgICAgICAgICBpZiAoIXNlYXJjaEFyZykge1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIHNvcnRPcHRpb25zID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGZpZWxkVG9TZWFyY2ggPSBzb3J0T3B0aW9uc1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNvcnRPcHRpb25zPy5bcmVsYXRpb25dKSB7XG4gICAgICAgICAgICAgICAgZmllbGRUb1NlYXJjaCA9IHNvcnRPcHRpb25zW3JlbGF0aW9uXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5OiB7XG4gICAgICAgICAgICAgIFtrZXk6IHN0cmluZ106IHVua25vd25cbiAgICAgICAgICAgICAgd2hlcmU6IFdoZXJlXG4gICAgICAgICAgICB9ID0ge1xuICAgICAgICAgICAgICBkZXB0aDogMCxcbiAgICAgICAgICAgICAgbGltaXQ6IG1heFJlc3VsdHNQZXJSZXF1ZXN0LFxuICAgICAgICAgICAgICBsb2NhbGUsXG4gICAgICAgICAgICAgIHBhZ2U6IGxhc3RMb2FkZWRQYWdlVG9Vc2UsXG4gICAgICAgICAgICAgIHNvcnQ6IGZpZWxkVG9TZWFyY2gsXG4gICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgYW5kOiBbXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgbm90X2luOiByZWxhdGlvbk1hcFtyZWxhdGlvbl0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzZWFyY2hBcmcpIHtcbiAgICAgICAgICAgICAgcXVlcnkud2hlcmUuYW5kLnB1c2goe1xuICAgICAgICAgICAgICAgIFtmaWVsZFRvU2VhcmNoXToge1xuICAgICAgICAgICAgICAgICAgbGlrZTogc2VhcmNoQXJnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChyZWxhdGlvbkZpbHRlck9wdGlvbiAmJiB0eXBlb2YgcmVsYXRpb25GaWx0ZXJPcHRpb24gIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICBxdWVyeS53aGVyZS5hbmQucHVzaChyZWxhdGlvbkZpbHRlck9wdGlvbilcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtzZXJ2ZXJVUkx9JHthcGl9LyR7cmVsYXRpb259PyR7cXMuc3RyaW5naWZ5KHF1ZXJ5KX1gLCB7XG4gICAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzogaTE4bi5sYW5ndWFnZSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICBjb25zdCBkYXRhOiBQYWdpbmF0ZWREb2NzPHVua25vd24+ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICAgICAgICAgIHNldExhc3RMb2FkZWRQYWdlKChwcmV2U3RhdGUpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgLi4ucHJldlN0YXRlLFxuICAgICAgICAgICAgICAgICAgW3JlbGF0aW9uXTogbGFzdExvYWRlZFBhZ2VUb1VzZSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgaWYgKCFkYXRhLm5leHRQYWdlKSB7XG4gICAgICAgICAgICAgICAgc2V0TGFzdEZ1bGx5TG9hZGVkUmVsYXRpb24ocmVsYXRpb25zLmluZGV4T2YocmVsYXRpb24pKVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGRhdGEuZG9jcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0c0ZldGNoZWQgKz0gZGF0YS5kb2NzLmxlbmd0aFxuXG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24sXG4gICAgICAgICAgICAgICAgICBjb25maWcsXG4gICAgICAgICAgICAgICAgICBkb2NzOiBkYXRhLmRvY3MsXG4gICAgICAgICAgICAgICAgICBpMThuLFxuICAgICAgICAgICAgICAgICAgc29ydCxcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdBREQnLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICAgICAgc2V0TGFzdEZ1bGx5TG9hZGVkUmVsYXRpb24ocmVsYXRpb25zLmluZGV4T2YocmVsYXRpb24pKVxuICAgICAgICAgICAgICBkaXNwYXRjaE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24sXG4gICAgICAgICAgICAgICAgY29uZmlnLFxuICAgICAgICAgICAgICAgIGRvY3M6IFtdLFxuICAgICAgICAgICAgICAgIGkxOG4sXG4gICAgICAgICAgICAgICAgaWRzOiByZWxhdGlvbk1hcFtyZWxhdGlvbl0sXG4gICAgICAgICAgICAgICAgc29ydCxcbiAgICAgICAgICAgICAgICB0eXBlOiAnQUREJyxcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHNldEVycm9yTG9hZGluZyh0KCdlcnJvcjp1bnNwZWNpZmljJykpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBQcm9taXNlLnJlc29sdmUoKSlcblxuICAgICAgICBpZiAodHlwZW9mIG9uU3VjY2VzcyA9PT0gJ2Z1bmN0aW9uJykgb25TdWNjZXNzKClcbiAgICAgIH1cbiAgICB9LFxuICAgIFtcbiAgICAgIHBlcm1pc3Npb25zLFxuICAgICAgcmVsYXRpb25UbyxcbiAgICAgIGhhc01hbnksXG4gICAgICBlcnJvckxvYWRpbmcsXG4gICAgICBzZWFyY2gsXG4gICAgICBsYXN0TG9hZGVkUGFnZSxcbiAgICAgIGNvbGxlY3Rpb25zLFxuICAgICAgbG9jYWxlLFxuICAgICAgZmlsdGVyT3B0aW9uc1Jlc3VsdCxcbiAgICAgIHNlcnZlclVSTCxcbiAgICAgIHNvcnRPcHRpb25zLFxuICAgICAgYXBpLFxuICAgICAgaTE4bixcbiAgICAgIGNvbmZpZyxcbiAgICAgIHQsXG4gICAgXSxcbiAgKVxuXG4gIGNvbnN0IHVwZGF0ZVNlYXJjaCA9IHVzZURlYm91bmNlZENhbGxiYWNrKChzZWFyY2hBcmc6IHN0cmluZywgdmFsdWVBcmc6IFZhbHVlIHwgVmFsdWVbXSkgPT4ge1xuICAgIGdldFJlc3VsdHMoeyBzZWFyY2g6IHNlYXJjaEFyZywgc29ydDogdHJ1ZSwgdmFsdWU6IHZhbHVlQXJnIH0pXG4gICAgc2V0U2VhcmNoKHNlYXJjaEFyZylcbiAgfSwgMzAwKVxuXG4gIGNvbnN0IGhhbmRsZUlucHV0Q2hhbmdlID0gdXNlQ2FsbGJhY2soXG4gICAgKHNlYXJjaEFyZzogc3RyaW5nLCB2YWx1ZUFyZzogVmFsdWUgfCBWYWx1ZVtdKSA9PiB7XG4gICAgICBpZiAoc2VhcmNoICE9PSBzZWFyY2hBcmcpIHtcbiAgICAgICAgc2V0TGFzdExvYWRlZFBhZ2Uoe30pXG4gICAgICAgIHVwZGF0ZVNlYXJjaChzZWFyY2hBcmcsIHZhbHVlQXJnLCBzZWFyY2hBcmcgIT09ICcnKVxuICAgICAgfVxuICAgIH0sXG4gICAgW3NlYXJjaCwgdXBkYXRlU2VhcmNoXSxcbiAgKVxuXG4gIC8vIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gIC8vIEVuc3VyZSB3ZSBoYXZlIGFuIG9wdGlvbiBmb3IgZWFjaCB2YWx1ZVxuICAvLyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgcmVsYXRpb25NYXAgPSBjcmVhdGVSZWxhdGlvbk1hcCh7XG4gICAgICBoYXNNYW55LFxuICAgICAgcmVsYXRpb25UbyxcbiAgICAgIHZhbHVlLFxuICAgIH0pXG5cbiAgICBPYmplY3QuZW50cmllcyhyZWxhdGlvbk1hcCkucmVkdWNlKGFzeW5jIChwcmlvclJlbGF0aW9uLCBbcmVsYXRpb24sIGlkc10pID0+IHtcbiAgICAgIGF3YWl0IHByaW9yUmVsYXRpb25cblxuICAgICAgY29uc3QgaWRzVG9Mb2FkID0gaWRzLmZpbHRlcigoaWQpID0+IHtcbiAgICAgICAgcmV0dXJuICFvcHRpb25zLmZpbmQoXG4gICAgICAgICAgKG9wdGlvbkdyb3VwKSA9PlxuICAgICAgICAgICAgb3B0aW9uR3JvdXA/Lm9wdGlvbnM/LmZpbmQoXG4gICAgICAgICAgICAgIChvcHRpb24pID0+IG9wdGlvbi52YWx1ZSA9PT0gaWQgJiYgb3B0aW9uLnJlbGF0aW9uVG8gPT09IHJlbGF0aW9uLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgKVxuICAgICAgfSlcblxuICAgICAgaWYgKGlkc1RvTG9hZC5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0ge1xuICAgICAgICAgIGRlcHRoOiAwLFxuICAgICAgICAgIGxpbWl0OiBpZHNUb0xvYWQubGVuZ3RoLFxuICAgICAgICAgIGxvY2FsZSxcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgaW46IGlkc1RvTG9hZCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZXJyb3JMb2FkaW5nKSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtzZXJ2ZXJVUkx9JHthcGl9LyR7cmVsYXRpb259PyR7cXMuc3RyaW5naWZ5KHF1ZXJ5KX1gLCB7XG4gICAgICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzogaTE4bi5sYW5ndWFnZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBjb2xsZWN0aW9ucy5maW5kKChjb2xsKSA9PiBjb2xsLnNsdWcgPT09IHJlbGF0aW9uKVxuICAgICAgICAgIGxldCBkb2NzID0gW11cblxuICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICAgICAgZG9jcyA9IGRhdGEuZG9jc1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGRpc3BhdGNoT3B0aW9ucyh7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLFxuICAgICAgICAgICAgY29uZmlnLFxuICAgICAgICAgICAgZG9jcyxcbiAgICAgICAgICAgIGkxOG4sXG4gICAgICAgICAgICBpZHM6IGlkc1RvTG9hZCxcbiAgICAgICAgICAgIHNvcnQ6IHRydWUsXG4gICAgICAgICAgICB0eXBlOiAnQUREJyxcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgUHJvbWlzZS5yZXNvbHZlKCkpXG4gIH0sIFtcbiAgICBvcHRpb25zLFxuICAgIHZhbHVlLFxuICAgIGhhc01hbnksXG4gICAgZXJyb3JMb2FkaW5nLFxuICAgIGNvbGxlY3Rpb25zLFxuICAgIGhhc011bHRpcGxlUmVsYXRpb25zLFxuICAgIHNlcnZlclVSTCxcbiAgICBhcGksXG4gICAgaTE4bixcbiAgICByZWxhdGlvblRvLFxuICAgIGxvY2FsZSxcbiAgICBjb25maWcsXG4gIF0pXG5cbiAgLy8gRGV0ZXJtaW5lIGlmIHdlIHNob3VsZCBzd2l0Y2ggdG8gd29yZCBib3VuZGFyeSBzZWFyY2hcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCByZWxhdGlvbnMgPSBBcnJheS5pc0FycmF5KHJlbGF0aW9uVG8pID8gcmVsYXRpb25UbyA6IFtyZWxhdGlvblRvXVxuICAgIGNvbnN0IGlzSWRPbmx5ID0gcmVsYXRpb25zLnJlZHVjZSgoaWRPbmx5LCByZWxhdGlvbikgPT4ge1xuICAgICAgY29uc3QgY29sbGVjdGlvbiA9IGNvbGxlY3Rpb25zLmZpbmQoKGNvbGwpID0+IGNvbGwuc2x1ZyA9PT0gcmVsYXRpb24pXG4gICAgICBjb25zdCBmaWVsZFRvU2VhcmNoID0gY29sbGVjdGlvbj8uYWRtaW4/LnVzZUFzVGl0bGUgfHwgJ2lkJ1xuICAgICAgcmV0dXJuIGZpZWxkVG9TZWFyY2ggPT09ICdpZCcgJiYgaWRPbmx5XG4gICAgfSwgdHJ1ZSlcbiAgICBzZXRFbmFibGVXb3JkQm91bmRhcnlTZWFyY2goIWlzSWRPbmx5KVxuICB9LCBbcmVsYXRpb25UbywgY29sbGVjdGlvbnNdKVxuXG4gIC8vIFdoZW4gKGByZWxhdGlvblRvYCB8fCBgZmlsdGVyT3B0aW9uc1Jlc3VsdGAgfHwgYGxvY2FsZWApIGNoYW5nZXMsIHJlc2V0IGNvbXBvbmVudFxuICAvLyBOb3RlIC0gZWZmZWN0IHNob3VsZCBub3QgcnVuIG9uIGZpcnN0IHJ1blxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChmaXJzdFJ1bi5jdXJyZW50KSB7XG4gICAgICBmaXJzdFJ1bi5jdXJyZW50ID0gZmFsc2VcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGRpc3BhdGNoT3B0aW9ucyh7IHR5cGU6ICdDTEVBUicgfSlcbiAgICBzZXRMYXN0RnVsbHlMb2FkZWRSZWxhdGlvbigtMSlcbiAgICBzZXRMYXN0TG9hZGVkUGFnZSh7fSlcbiAgICBzZXRIYXNMb2FkZWRGaXJzdFBhZ2UoZmFsc2UpXG4gIH0sIFtyZWxhdGlvblRvLCBmaWx0ZXJPcHRpb25zUmVzdWx0LCBsb2NhbGVdKVxuXG4gIGNvbnN0IG9uU2F2ZSA9IHVzZUNhbGxiYWNrPERvY3VtZW50RHJhd2VyUHJvcHNbJ29uU2F2ZSddPihcbiAgICAoYXJncykgPT4ge1xuICAgICAgZGlzcGF0Y2hPcHRpb25zKHtcbiAgICAgICAgY29sbGVjdGlvbjogYXJncy5jb2xsZWN0aW9uQ29uZmlnLFxuICAgICAgICBjb25maWcsXG4gICAgICAgIGRvYzogYXJncy5kb2MsXG4gICAgICAgIGkxOG4sXG4gICAgICAgIHR5cGU6ICdVUERBVEUnLFxuICAgICAgfSlcbiAgICB9LFxuICAgIFtpMThuLCBjb25maWddLFxuICApXG5cbiAgY29uc3QgZmlsdGVyT3B0aW9uID0gdXNlQ2FsbGJhY2soKGl0ZW06IE9wdGlvbiwgc2VhcmNoRmlsdGVyOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoIXNlYXJjaEZpbHRlcikge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgY29uc3QgciA9IHdvcmRCb3VuZGFyaWVzUmVnZXgoc2VhcmNoRmlsdGVyIHx8ICcnKVxuICAgIC8vIGJyZWFraW5nIHRoZSBsYWJlbHMgdG8gc2VhcmNoIGludG8gc21hbGxlciBwYXJ0cyBpbmNyZWFzZXMgcGVyZm9ybWFuY2VcbiAgICBjb25zdCBicmVha0FwYXJ0VGhyZXNob2xkID0gMjUwXG4gICAgbGV0IHN0cmluZyA9IGl0ZW0ubGFiZWxcbiAgICAvLyBzdHJpbmdzIGxlc3MgdGhhbiBicmVha0FwYXJ0VGhyZXNob2xkIGxlbmd0aCB3b24ndCBiZSBjaHVua2VkXG4gICAgd2hpbGUgKHN0cmluZy5sZW5ndGggPiBicmVha0FwYXJ0VGhyZXNob2xkKSB7XG4gICAgICAvLyBzbGljaW5nIGJ5IHRoZSBuZXh0IHNwYWNlIGFmdGVyIHRoZSBsZW5ndGggb2YgdGhlIHNlYXJjaCBpbnB1dCBwcmV2ZW50cyBzbGljaW5nIHRoZSBzdHJpbmcgdXAgYnkgcGFydGlhbCB3b3Jkc1xuICAgICAgY29uc3QgaW5kZXhPZlNwYWNlID0gc3RyaW5nLmluZGV4T2YoJyAnLCBzZWFyY2hGaWx0ZXIubGVuZ3RoKVxuICAgICAgaWYgKHIudGVzdChzdHJpbmcuc2xpY2UoMCwgaW5kZXhPZlNwYWNlID09PSAtMSA/IHNlYXJjaEZpbHRlci5sZW5ndGggOiBpbmRleE9mU3BhY2UgKyAxKSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICAgIHN0cmluZyA9IHN0cmluZy5zbGljZShpbmRleE9mU3BhY2UgPT09IC0xID8gc2VhcmNoRmlsdGVyLmxlbmd0aCA6IGluZGV4T2ZTcGFjZSArIDEpXG4gICAgfVxuICAgIHJldHVybiByLnRlc3Qoc3RyaW5nLnNsaWNlKC1icmVha0FwYXJ0VGhyZXNob2xkKSlcbiAgfSwgW10pXG5cbiAgY29uc3QgdmFsdWVUb1JlbmRlciA9IGZpbmRPcHRpb25zQnlWYWx1ZSh7IG9wdGlvbnMsIHZhbHVlIH0pXG5cbiAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlVG9SZW5kZXIpICYmIHZhbHVlVG9SZW5kZXI/LnZhbHVlID09PSAnbnVsbCcpIHZhbHVlVG9SZW5kZXIudmFsdWUgPSBudWxsXG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjbGFzc05hbWU9e1tcbiAgICAgICAgZmllbGRCYXNlQ2xhc3MsXG4gICAgICAgIGJhc2VDbGFzcyxcbiAgICAgICAgY2xhc3NOYW1lLFxuICAgICAgICBzaG93RXJyb3IgJiYgJ2Vycm9yJyxcbiAgICAgICAgZXJyb3JMb2FkaW5nICYmICdlcnJvci1sb2FkaW5nJyxcbiAgICAgICAgcmVhZE9ubHkgJiYgYCR7YmFzZUNsYXNzfS0tcmVhZC1vbmx5YCxcbiAgICAgIF1cbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAuam9pbignICcpfVxuICAgICAgaWQ9e2BmaWVsZC0ke3BhdGhPck5hbWUucmVwbGFjZSgvXFwuL2csICdfXycpfWB9XG4gICAgICBzdHlsZT17e1xuICAgICAgICAuLi5zdHlsZSxcbiAgICAgICAgd2lkdGgsXG4gICAgICB9fVxuICAgID5cbiAgICAgIDxFcnJvckNvbXAgbWVzc2FnZT17ZXJyb3JNZXNzYWdlfSBzaG93RXJyb3I9e3Nob3dFcnJvcn0gLz5cbiAgICAgIDxMYWJlbENvbXAgaHRtbEZvcj17cGF0aE9yTmFtZX0gbGFiZWw9e2xhYmVsfSByZXF1aXJlZD17cmVxdWlyZWR9IC8+XG4gICAgICA8R2V0RmlsdGVyT3B0aW9uc1xuICAgICAgICB7Li4ue1xuICAgICAgICAgIGZpbHRlck9wdGlvbnMsXG4gICAgICAgICAgZmlsdGVyT3B0aW9uc1Jlc3VsdCxcbiAgICAgICAgICBwYXRoOiBwYXRoT3JOYW1lLFxuICAgICAgICAgIHJlbGF0aW9uVG8sXG4gICAgICAgICAgc2V0RmlsdGVyT3B0aW9uc1Jlc3VsdCxcbiAgICAgICAgfX1cbiAgICAgIC8+XG4gICAgICB7IWVycm9yTG9hZGluZyAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X193cmFwYH0+XG4gICAgICAgICAgPFJlYWN0U2VsZWN0XG4gICAgICAgICAgICBiYWNrc3BhY2VSZW1vdmVzVmFsdWU9eyFkcmF3ZXJJc09wZW59XG4gICAgICAgICAgICBjb21wb25lbnRzPXt7XG4gICAgICAgICAgICAgIE11bHRpVmFsdWVMYWJlbCxcbiAgICAgICAgICAgICAgU2luZ2xlVmFsdWUsXG4gICAgICAgICAgICB9fVxuICAgICAgICAgICAgY3VzdG9tUHJvcHM9e3tcbiAgICAgICAgICAgICAgZGlzYWJsZUtleURvd246IGRyYXdlcklzT3BlbixcbiAgICAgICAgICAgICAgZGlzYWJsZU1vdXNlRG93bjogZHJhd2VySXNPcGVuLFxuICAgICAgICAgICAgICBvblNhdmUsXG4gICAgICAgICAgICAgIHNldERyYXdlcklzT3BlbixcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICBkaXNhYmxlZD17cmVhZE9ubHkgfHwgZm9ybVByb2Nlc3Npbmd9XG4gICAgICAgICAgICBmaWx0ZXJPcHRpb249e2VuYWJsZVdvcmRCb3VuZGFyeVNlYXJjaCA/IGZpbHRlck9wdGlvbiA6IHVuZGVmaW5lZH1cbiAgICAgICAgICAgIGlzTG9hZGluZz17aXNMb2FkaW5nfVxuICAgICAgICAgICAgaXNNdWx0aT17aGFzTWFueX1cbiAgICAgICAgICAgIGlzU29ydGFibGU9e2lzU29ydGFibGV9XG4gICAgICAgICAgICBvbkNoYW5nZT17XG4gICAgICAgICAgICAgICFyZWFkT25seVxuICAgICAgICAgICAgICAgID8gKHNlbGVjdGVkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgIHNldFZhbHVlKGhhc01hbnkgPyBbXSA6IG51bGwpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzTWFueSkge1xuICAgICAgICAgICAgICAgICAgICAgIHNldFZhbHVlKFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPyBzZWxlY3RlZC5tYXAoKG9wdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc011bHRpcGxlUmVsYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpb25Ubzogb3B0aW9uLnJlbGF0aW9uVG8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG9wdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9uLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYXNNdWx0aXBsZVJlbGF0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICAgIHNldFZhbHVlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uVG86IHNlbGVjdGVkLnJlbGF0aW9uVG8sXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogc2VsZWN0ZWQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZXRWYWx1ZShzZWxlY3RlZC52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvbklucHV0Q2hhbmdlPXsobmV3U2VhcmNoKSA9PiBoYW5kbGVJbnB1dENoYW5nZShuZXdTZWFyY2gsIHZhbHVlKX1cbiAgICAgICAgICAgIG9uTWVudU9wZW49eygpID0+IHtcbiAgICAgICAgICAgICAgaWYgKCFoYXNMb2FkZWRGaXJzdFBhZ2UpIHtcbiAgICAgICAgICAgICAgICBzZXRJc0xvYWRpbmcodHJ1ZSlcbiAgICAgICAgICAgICAgICBnZXRSZXN1bHRzKHtcbiAgICAgICAgICAgICAgICAgIG9uU3VjY2VzczogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZXRIYXNMb2FkZWRGaXJzdFBhZ2UodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHZhbHVlOiBpbml0aWFsVmFsdWUsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIG9uTWVudVNjcm9sbFRvQm90dG9tPXsoKSA9PiB7XG4gICAgICAgICAgICAgIGdldFJlc3VsdHMoe1xuICAgICAgICAgICAgICAgIGxhc3RGdWxseUxvYWRlZFJlbGF0aW9uLFxuICAgICAgICAgICAgICAgIHNlYXJjaCxcbiAgICAgICAgICAgICAgICBzb3J0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogaW5pdGlhbFZhbHVlLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIG9wdGlvbnM9e29wdGlvbnN9XG4gICAgICAgICAgICBzaG93RXJyb3I9e3Nob3dFcnJvcn1cbiAgICAgICAgICAgIHZhbHVlPXt2YWx1ZVRvUmVuZGVyID8/IG51bGx9XG4gICAgICAgICAgLz5cbiAgICAgICAgICB7IXJlYWRPbmx5ICYmIGFsbG93Q3JlYXRlICYmIChcbiAgICAgICAgICAgIDxBZGROZXdSZWxhdGlvblxuICAgICAgICAgICAgICB7Li4ue1xuICAgICAgICAgICAgICAgIGRpc3BhdGNoT3B0aW9ucyxcbiAgICAgICAgICAgICAgICBoYXNNYW55LFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgcGF0aDogcGF0aE9yTmFtZSxcbiAgICAgICAgICAgICAgICByZWxhdGlvblRvLFxuICAgICAgICAgICAgICAgIHNldFZhbHVlLFxuICAgICAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgICB7ZXJyb3JMb2FkaW5nICYmIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19lcnJvci1sb2FkaW5nYH0+e2Vycm9yTG9hZGluZ308L2Rpdj59XG4gICAgICA8RmllbGREZXNjcmlwdGlvbiBkZXNjcmlwdGlvbj17ZGVzY3JpcHRpb259IHBhdGg9e3BhdGh9IHZhbHVlPXt2YWx1ZX0gLz5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCB3aXRoQ29uZGl0aW9uKFJlbGF0aW9uc2hpcClcbiJdLCJuYW1lcyI6WyJtYXhSZXN1bHRzUGVyUmVxdWVzdCIsImJhc2VDbGFzcyIsIlJlbGF0aW9uc2hpcCIsInByb3BzIiwibmFtZSIsImFkbWluIiwiYWxsb3dDcmVhdGUiLCJjbGFzc05hbWUiLCJjb21wb25lbnRzIiwiRXJyb3IiLCJMYWJlbCIsImNvbmRpdGlvbiIsImRlc2NyaXB0aW9uIiwiaXNTb3J0YWJsZSIsInJlYWRPbmx5Iiwic29ydE9wdGlvbnMiLCJzdHlsZSIsIndpZHRoIiwiZmlsdGVyT3B0aW9ucyIsImhhc01hbnkiLCJsYWJlbCIsInBhdGgiLCJyZWxhdGlvblRvIiwicmVxdWlyZWQiLCJ2YWxpZGF0ZSIsInJlbGF0aW9uc2hpcCIsIkVycm9yQ29tcCIsIkRlZmF1bHRFcnJvciIsIkxhYmVsQ29tcCIsIkRlZmF1bHRMYWJlbCIsImNvbmZpZyIsInVzZUNvbmZpZyIsImNvbGxlY3Rpb25zIiwicm91dGVzIiwiYXBpIiwic2VydmVyVVJMIiwiaTE4biIsInQiLCJ1c2VUcmFuc2xhdGlvbiIsInBlcm1pc3Npb25zIiwidXNlQXV0aCIsImNvZGUiLCJsb2NhbGUiLCJ1c2VMb2NhbGUiLCJmb3JtUHJvY2Vzc2luZyIsInVzZUZvcm1Qcm9jZXNzaW5nIiwiaGFzTXVsdGlwbGVSZWxhdGlvbnMiLCJBcnJheSIsImlzQXJyYXkiLCJvcHRpb25zIiwiZGlzcGF0Y2hPcHRpb25zIiwidXNlUmVkdWNlciIsIm9wdGlvbnNSZWR1Y2VyIiwibGFzdEZ1bGx5TG9hZGVkUmVsYXRpb24iLCJzZXRMYXN0RnVsbHlMb2FkZWRSZWxhdGlvbiIsInVzZVN0YXRlIiwibGFzdExvYWRlZFBhZ2UiLCJzZXRMYXN0TG9hZGVkUGFnZSIsImVycm9yTG9hZGluZyIsInNldEVycm9yTG9hZGluZyIsImZpbHRlck9wdGlvbnNSZXN1bHQiLCJzZXRGaWx0ZXJPcHRpb25zUmVzdWx0Iiwic2VhcmNoIiwic2V0U2VhcmNoIiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwiaGFzTG9hZGVkRmlyc3RQYWdlIiwic2V0SGFzTG9hZGVkRmlyc3RQYWdlIiwiZW5hYmxlV29yZEJvdW5kYXJ5U2VhcmNoIiwic2V0RW5hYmxlV29yZEJvdW5kYXJ5U2VhcmNoIiwiZmlyc3RSdW4iLCJ1c2VSZWYiLCJwYXRoT3JOYW1lIiwibWVtb2l6ZWRWYWxpZGF0ZSIsInVzZUNhbGxiYWNrIiwidmFsdWUiLCJ2YWxpZGF0aW9uT3B0aW9ucyIsImVycm9yTWVzc2FnZSIsImluaXRpYWxWYWx1ZSIsInNldFZhbHVlIiwic2hvd0Vycm9yIiwidXNlRmllbGQiLCJkcmF3ZXJJc09wZW4iLCJzZXREcmF3ZXJJc09wZW4iLCJnZXRSZXN1bHRzIiwibGFzdEZ1bGx5TG9hZGVkUmVsYXRpb25BcmciLCJvblN1Y2Nlc3MiLCJzZWFyY2hBcmciLCJzb3J0IiwidmFsdWVBcmciLCJsYXN0RnVsbHlMb2FkZWRSZWxhdGlvblRvVXNlIiwicmVsYXRpb25zIiwicmVsYXRpb25zVG9GZXRjaCIsInNsaWNlIiwicmVzdWx0c0ZldGNoZWQiLCJyZWxhdGlvbk1hcCIsImNyZWF0ZVJlbGF0aW9uTWFwIiwicmVkdWNlIiwicHJpb3JSZWxhdGlvbiIsInJlbGF0aW9uIiwicmVsYXRpb25GaWx0ZXJPcHRpb24iLCJsYXN0TG9hZGVkUGFnZVRvVXNlIiwiaW5kZXhPZiIsIlByb21pc2UiLCJyZXNvbHZlIiwiY29sbGVjdGlvbiIsImZpbmQiLCJjb2xsIiwic2x1ZyIsImZpZWxkVG9TZWFyY2giLCJkZWZhdWx0U29ydCIsInVzZUFzVGl0bGUiLCJxdWVyeSIsImRlcHRoIiwibGltaXQiLCJwYWdlIiwid2hlcmUiLCJhbmQiLCJpZCIsIm5vdF9pbiIsInB1c2giLCJsaWtlIiwicmVzcG9uc2UiLCJmZXRjaCIsInFzIiwic3RyaW5naWZ5IiwiY3JlZGVudGlhbHMiLCJoZWFkZXJzIiwibGFuZ3VhZ2UiLCJvayIsImRhdGEiLCJqc29uIiwicHJldlN0YXRlIiwibmV4dFBhZ2UiLCJkb2NzIiwibGVuZ3RoIiwidHlwZSIsInN0YXR1cyIsImlkcyIsInVwZGF0ZVNlYXJjaCIsInVzZURlYm91bmNlZENhbGxiYWNrIiwiaGFuZGxlSW5wdXRDaGFuZ2UiLCJ1c2VFZmZlY3QiLCJPYmplY3QiLCJlbnRyaWVzIiwiaWRzVG9Mb2FkIiwiZmlsdGVyIiwib3B0aW9uR3JvdXAiLCJvcHRpb24iLCJpbiIsImlzSWRPbmx5IiwiaWRPbmx5IiwiY3VycmVudCIsIm9uU2F2ZSIsImFyZ3MiLCJjb2xsZWN0aW9uQ29uZmlnIiwiZG9jIiwiZmlsdGVyT3B0aW9uIiwiaXRlbSIsInNlYXJjaEZpbHRlciIsInIiLCJ3b3JkQm91bmRhcmllc1JlZ2V4IiwiYnJlYWtBcGFydFRocmVzaG9sZCIsInN0cmluZyIsImluZGV4T2ZTcGFjZSIsInRlc3QiLCJ2YWx1ZVRvUmVuZGVyIiwiZmluZE9wdGlvbnNCeVZhbHVlIiwiZGl2IiwiZmllbGRCYXNlQ2xhc3MiLCJCb29sZWFuIiwiam9pbiIsInJlcGxhY2UiLCJtZXNzYWdlIiwiaHRtbEZvciIsIkdldEZpbHRlck9wdGlvbnMiLCJSZWFjdFNlbGVjdCIsImJhY2tzcGFjZVJlbW92ZXNWYWx1ZSIsIk11bHRpVmFsdWVMYWJlbCIsIlNpbmdsZVZhbHVlIiwiY3VzdG9tUHJvcHMiLCJkaXNhYmxlS2V5RG93biIsImRpc2FibGVNb3VzZURvd24iLCJkaXNhYmxlZCIsInVuZGVmaW5lZCIsImlzTXVsdGkiLCJvbkNoYW5nZSIsInNlbGVjdGVkIiwibWFwIiwib25JbnB1dENoYW5nZSIsIm5ld1NlYXJjaCIsIm9uTWVudU9wZW4iLCJvbk1lbnVTY3JvbGxUb0JvdHRvbSIsIkFkZE5ld1JlbGF0aW9uIiwiRmllbGREZXNjcmlwdGlvbiIsIndpdGhDb25kaXRpb24iXSwibWFwcGluZ3MiOiI7Ozs7K0JBNGhCQTs7O2VBQUE7OzsyREE1aEJlOytEQUM2RDs4QkFDN0M7NkJBT0Y7NEVB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